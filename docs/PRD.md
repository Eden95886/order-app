# 커피 주문 앱

## 1. 프로젝트 개요

### 1.2 프로젝트 목적
사용자가 커피 메뉴를 주문하고, 관리자가 주문을 관리할 수 있는 간단한 풀스택 웹 앱

### 1.3 개발 범위
- 주문하기 화면(메뉴 선택 및 장바구니 기능)
- 관리자 화면(재고 관리 및 주문 상태 관리)
- 데이터를 생성/조회/수정/삭제할 수 있는 기능

## 2. 기술 스택
- 프런트엔드: HTML, CSS, 리액트, 자바스크립트
- 백엔드: Node.js, Express
- 데이터베이스: PostgreSQL

## 3. 기본 사항
- 프런트엔드와 백엔드를 따로 개발
- 기본적인 웹 기술만 사용
- 학습 목적이므로 사용자 인증이나 결제 기능은 제외
- 메뉴는 커피 메뉴만 있음

## 4. 주문하기 화면 상세 설계

### 4.1 화면 레이아웃
주문하기 화면은 상단 헤더, 중앙 메뉴 아이템 영역, 하단 장바구니 영역으로 구성됩니다.

### 4.2 헤더 영역
**위치**: 화면 최상단
**구성 요소**:
- 좌측: 브랜드명 "COZY" 표시 (사각형 박스 안에 표시)
- 우측: 네비게이션 버튼
  - "주문하기" 버튼 (현재 화면이므로 활성화 상태)
  - "관리자" 버튼 (클릭 시 관리자 화면으로 이동)

### 4.3 메뉴 아이템 영역
**위치**: 헤더 아래, 화면 중앙 상단
**레이아웃**: 메뉴 아이템 카드들을 가로로 나열 (수평 스크롤 또는 그리드 레이아웃)

**각 메뉴 카드 구성 요소**:
1. **상품 이미지 영역**
   - 사각형 이미지 영역 (이미지가 없을 경우 플레이스홀더 표시)

2. **상품 정보**
   - 상품명 (예: "아메리카노(ICE)", "아메리카노(HOT)", "카페라떼")
   - 기본 가격 (원 단위로 표시, 예: "4,000원", "5,000원")
   - 간단한 설명 텍스트 (예: "간단한 설명...")

3. **추가 옵션**
   - 체크박스 형태의 옵션 선택
     - "샷 추가 (+500원)": 체크 시 가격에 500원 추가
     - "시럽 추가 (+0원)": 체크 시 가격 변동 없음
   - 각 옵션은 독립적으로 선택 가능 (다중 선택 가능)

4. **담기 버튼**
   - 카드 하단에 "담기" 버튼 배치
   - 클릭 시 선택한 옵션과 함께 장바구니에 추가

### 4.4 장바구니 영역
**위치**: 화면 하단
**레이아웃**: 사각형 박스로 구분된 별도 영역

**구성 요소**:
1. **섹션 제목**
   - 좌측 상단에 "장바구니" 텍스트 표시

2. **주문 목록**
   - 장바구니에 담긴 각 아이템을 목록 형태로 표시
   - 각 아이템 표시 형식: `상품명 (옵션) X 수량 - 가격`
   - 예시:
     - "아메리카노(ICE) (샷 추가) X 1 - 4,500원"
     - "아메리카노(HOT) X 2 - 8,000원"
   - 옵션이 없는 경우 "(옵션)" 표시 생략

3. **총 금액**
   - 장바구니에 담긴 모든 아이템의 가격 합계
   - 표시 형식: "총 금액 XX,XXX원"
   - 동적으로 계산되어 표시

4. **주문하기 버튼**
   - 총 금액 아래에 배치된 주요 액션 버튼
   - 버튼 텍스트: "주문하기"
   - 클릭 시 주문 처리 (백엔드 API 호출)

### 4.5 기능 요구사항

#### 4.5.1 메뉴 아이템 표시
- 백엔드 API로부터 메뉴 데이터를 가져와 카드 형태로 표시
- 메뉴 데이터에는 상품명, 기본 가격, 설명, 이미지 URL 포함
- 이미지가 없는 경우 플레이스홀더 표시

#### 4.5.2 옵션 선택
- 사용자는 각 메뉴 아이템에 대해 옵션을 선택/해제할 수 있음
- 옵션 선택 상태는 체크박스로 표시
- 옵션별 추가 금액이 가격에 반영되어 표시되어야 함 (선택적 표시 가능)

#### 4.5.3 장바구니 관리
- "담기" 버튼 클릭 시 현재 선택된 옵션과 함께 장바구니에 추가
- 동일한 상품+옵션 조합이 장바구니에 있으면 수량 증가, 없으면 새 항목 추가
- 장바구니에 담긴 아이템 목록이 실시간으로 업데이트
- 총 금액은 장바구니 내 모든 아이템의 (단가 × 수량) 합계로 자동 계산

#### 4.5.4 주문 처리
- "주문하기" 버튼 클릭 시:
  - 장바구니가 비어있으면 주문 불가 처리
  - 장바구니에 아이템이 있으면 주문 데이터를 백엔드 API로 전송
  - 주문 성공 시 장바구니 비우기 및 성공 메시지 표시
  - 주문 실패 시 에러 메시지 표시

### 4.6 UI/UX 요구사항
- 반응형 디자인으로 다양한 화면 크기 지원
- 메뉴 카드는 가로 스크롤 또는 그리드 레이아웃으로 여러 개 표시
- 옵션 선택 시 즉각적인 피드백 제공 (체크박스 상태 변경)
- 장바구니 영역은 항상 화면 하단에 고정 또는 스크롤 가능한 형태
- 버튼 클릭 시 적절한 시각적 피드백 제공
- 로딩 상태 표시 (API 호출 중일 때)

### 4.7 상태 관리
- 메뉴 목록 상태
- 장바구니 아이템 상태 (배열 형태)
- 선택된 옵션 상태 (각 메뉴 카드별로 관리)

### 4.8 데이터 구조

#### 메뉴 아이템 데이터 구조
```javascript
{
  id: number,           // 메뉴 고유 ID
  name: string,         // 상품명
  price: number,        // 기본 가격
  description: string,  // 상품 설명
  imageUrl: string,     // 이미지 URL (선택사항)
  options: [            // 추가 옵션 목록
    {
      id: number,       // 옵션 고유 ID
      name: string,     // 옵션명 (예: "샷 추가")
      price: number     // 추가 금액
    }
  ]
}
```

#### 장바구니 아이템 데이터 구조
```javascript
{
  menuId: number,       // 메뉴 ID
  menuName: string,     // 상품명
  basePrice: number,    // 기본 가격
  selectedOptions: [    // 선택된 옵션 ID 배열
    number
  ],
  quantity: number,     // 수량
  totalPrice: number    // 총 가격 (기본 가격 + 옵션 가격) * 수량
}
```

## 5. 관리자 화면 상세 설계

### 5.1 화면 레이아웃
관리자 화면은 상단 헤더, 관리자 대시보드 영역, 재고 현황 영역, 주문 현황 영역으로 구성됩니다.

### 5.2 헤더 영역
**위치**: 화면 최상단
**구성 요소**:
- 좌측: 브랜드명 "COZY" 표시 (사각형 박스 안에 표시)
- 우측: 네비게이션 버튼
  - "주문하기" 버튼 (클릭 시 주문하기 화면으로 이동)
  - "관리자" 버튼 (현재 화면이므로 활성화 상태, 더 진한 테두리로 표시)

### 5.3 관리자 대시보드 영역
**위치**: 헤더 아래, 화면 상단
**레이아웃**: 회색 배경의 사각형 박스로 구분된 별도 영역

**구성 요소**:
1. **섹션 제목**
   - 좌측 상단에 "관리자 대시보드" 텍스트 표시

2. **주문 통계 요약**
   - 현재 주문 상태별 통계를 요약하여 표시
   - 표시 형식: "총 주문 X / 주문 접수 X / 제조 중 X / 제조 완료 X"
   - 예시: "총 주문 1 / 주문 접수 1 / 제조 중 0 / 제조 완료 0"
   - 각 통계는 실시간으로 업데이트됨

### 5.4 재고 현황 영역
**위치**: 관리자 대시보드 아래
**레이아웃**: 회색 배경의 사각형 박스로 구분된 별도 영역, 상품 카드들을 가로로 나열

**구성 요소**:
1. **섹션 제목**
   - 좌측 상단에 "재고 현황" 텍스트 표시

2. **재고 카드**
   - 각 메뉴 아이템별로 재고 카드를 생성
   - 카드는 가로로 나열 (그리드 레이아웃)
   - **각 재고 카드 구성 요소**:
     - 상품명 (예: "아메리카노(ICE)", "아메리카노(HOT)", "카페라떼")
     - 현재 재고 수량 (예: "10개")
     - 재고 조정 버튼
       - "+" 버튼: 클릭 시 재고 1개 증가
       - "-" 버튼: 클릭 시 재고 1개 감소
     - 재고 수량은 0 이상의 값만 가능 (음수 불가)

### 5.5 주문 현황 영역
**위치**: 재고 현황 아래, 화면 하단
**레이아웃**: 회색 배경의 사각형 박스로 구분된 별도 영역

**구성 요소**:
1. **섹션 제목**
   - 좌측 상단에 "주문 현황" 텍스트 표시

2. **주문 목록**
   - 각 주문을 카드 형태로 표시
   - 주문 카드는 시간순으로 정렬 (최신 주문이 위쪽)
   - **각 주문 카드 구성 요소**:
     - 주문 일시: "월 일 시:분" 형식 (예: "7월 31일 13:00")
     - 주문 내용: 주문한 상품명과 수량 (예: "아메리카노(ICE) x 1")
       - 옵션이 있는 경우 옵션 정보도 표시 (예: "아메리카노(ICE) (샷 추가) x 1")
       - 여러 상품이 있을 경우 각각 나열
     - 주문 금액: 해당 주문의 총 금액 (예: "4,000원")
     - 상태 변경 버튼:
       - 주문 상태에 따라 다른 버튼이 표시됨
       - 초기 상태: "주문 접수" 버튼 (클릭 시 주문 접수 상태로 변경)
       - 주문 접수 후: "제조 시작" 버튼 (클릭 시 제조 중 상태로 변경)
       - 제조 중: "제조 완료" 버튼 (클릭 시 제조 완료 상태로 변경)
       - 제조 완료: 버튼 숨김 또는 "완료" 표시만

### 5.6 기능 요구사항

#### 5.6.1 대시보드 통계 조회
- 백엔드 API로부터 현재 주문 통계를 가져와 표시
- 통계는 다음 4가지 상태별로 집계:
  - 총 주문: 전체 주문 수
  - 주문 접수: 주문 접수 상태인 주문 수
  - 제조 중: 제조 중 상태인 주문 수
  - 제조 완료: 제조 완료 상태인 주문 수
- 통계는 주기적으로 또는 실시간으로 업데이트 (폴링 또는 웹소켓 사용 가능)

#### 5.6.2 재고 관리
- 백엔드 API로부터 현재 재고 현황을 가져와 표시
- "+" 버튼 클릭 시:
  - 해당 상품의 재고를 1개 증가
  - 백엔드 API로 재고 증가 요청 전송
  - 성공 시 화면의 재고 수량 즉시 업데이트
- "-" 버튼 클릭 시:
  - 해당 상품의 재고가 0보다 큰 경우에만 감소 가능
  - 재고를 1개 감소
  - 백엔드 API로 재고 감소 요청 전송
  - 성공 시 화면의 재고 수량 즉시 업데이트
- 재고 수정 실패 시 에러 메시지 표시

#### 5.6.3 주문 목록 조회
- 백엔드 API로부터 현재 주문 목록을 가져와 표시
- 주문 목록에는 주문 ID, 주문 일시, 주문 내용, 주문 금액, 주문 상태 포함
- 주문 목록은 최신 주문이 위에 오도록 시간 역순으로 정렬

#### 5.6.4 주문 상태 관리
- 각 주문의 현재 상태에 따라 적절한 액션 버튼 표시
- **주문 접수** 버튼 클릭 시:
  - 주문 상태를 "주문 접수"로 변경
  - 백엔드 API로 주문 상태 업데이트 요청 전송
  - 성공 시 대시보드 통계 업데이트 및 버튼 텍스트 변경
- **제조 시작** 버튼 클릭 시:
  - 주문 상태를 "제조 중"으로 변경
  - 백엔드 API로 주문 상태 업데이트 요청 전송
  - 성공 시 대시보드 통계 업데이트 및 버튼 텍스트 변경
  - 해당 주문의 상품 재고가 있는지 확인 (선택사항)
- **제조 완료** 버튼 클릭 시:
  - 주문 상태를 "제조 완료"로 변경
  - 백엔드 API로 주문 상태 업데이트 요청 전송
  - 성공 시 대시보드 통계 업데이트 및 주문 카드에서 버튼 제거 또는 "완료" 표시
- 상태 변경 실패 시 에러 메시지 표시

### 5.7 UI/UX 요구사항
- 반응형 디자인으로 다양한 화면 크기 지원
- 각 영역은 회색 배경의 박스로 시각적으로 구분
- 재고 카드는 가로 스크롤 또는 그리드 레이아웃으로 여러 개 표시
- 주문 목록은 스크롤 가능한 영역으로 구현 (주문이 많을 경우)
- 버튼 클릭 시 적절한 시각적 피드백 제공
- 로딩 상태 표시 (API 호출 중일 때)
- 재고 조정 시 즉각적인 UI 업데이트 (낙관적 업데이트 권장)
- 주문 상태 변경 시 버튼 텍스트 및 스타일 즉시 변경

### 5.8 상태 관리
- 대시보드 통계 상태
- 재고 현황 상태 (배열 형태)
- 주문 목록 상태 (배열 형태)
- 각 주문의 상태 상태

### 5.9 데이터 구조

#### 대시보드 통계 데이터 구조
```javascript
{
  totalOrders: number,      // 총 주문 수
  receivedOrders: number,   // 주문 접수 수
  inProgressOrders: number, // 제조 중 수
  completedOrders: number   // 제조 완료 수
}
```

#### 재고 아이템 데이터 구조
```javascript
{
  menuId: number,           // 메뉴 고유 ID
  menuName: string,         // 상품명
  stock: number             // 현재 재고 수량
}
```

#### 주문 데이터 구조
```javascript
{
  id: number,               // 주문 고유 ID
  orderDate: string,        // 주문 일시 (ISO 8601 형식 또는 Date 객체)
  items: [                  // 주문 아이템 목록
    {
      menuId: number,       // 메뉴 ID
      menuName: string,     // 상품명
      quantity: number,     // 수량
      options: [            // 선택된 옵션 배열
        {
          id: number,       // 옵션 ID
          name: string      // 옵션명
        }
      ],
      price: number         // 단가 (기본 가격 + 옵션 가격)
    }
  ],
  totalPrice: number,       // 주문 총 금액
  status: string           // 주문 상태: "pending" | "received" | "in_progress" | "completed"
}
```

#### 주문 상태 값
- `"pending"`: 주문 대기 중 (주문 접수 전)
- `"received"`: 주문 접수
- `"in_progress"`: 제조 중
- `"completed"`: 제조 완료

## 6. 백엔드 개발 설계

### 6.1 데이터 모델

#### 6.1.1 Menus (메뉴)
메뉴 정보를 저장하는 테이블입니다.

**필드 구성**:
- `id` (PRIMARY KEY): 메뉴 고유 ID (자동 증가)
- `name` (VARCHAR): 커피 이름 (예: "아메리카노(ICE)", "카페라떼")
- `description` (TEXT): 메뉴 설명 (예: "깔끔하고 부드러운 아이스 아메리카노")
- `price` (INTEGER): 기본 가격 (원 단위)
- `image_url` (VARCHAR): 이미지 URL (선택사항, NULL 허용)
- `stock` (INTEGER): 재고 수량 (기본값: 0)
- `created_at` (TIMESTAMP): 생성 일시
- `updated_at` (TIMESTAMP): 수정 일시

**제약 조건**:
- `name`: 필수, 중복 불가
- `price`: 필수, 0 이상
- `stock`: 필수, 0 이상

#### 6.1.2 Options (옵션)
메뉴에 추가할 수 있는 옵션 정보를 저장하는 테이블입니다.

**필드 구성**:
- `id` (PRIMARY KEY): 옵션 고유 ID (자동 증가)
- `name` (VARCHAR): 옵션 이름 (예: "샷 추가", "시럽 추가")
- `price` (INTEGER): 옵션 추가 가격 (원 단위, 0 가능)
- `menu_id` (FOREIGN KEY): 연결할 메뉴 ID (Menus 테이블 참조)
- `created_at` (TIMESTAMP): 생성 일시
- `updated_at` (TIMESTAMP): 수정 일시

**제약 조건**:
- `name`: 필수
- `price`: 필수 (0 이상, 음수 가능하지만 일반적으로 0 이상)
- `menu_id`: 필수, Menus 테이블의 존재하는 ID 참조

**관계**:
- 하나의 메뉴는 여러 개의 옵션을 가질 수 있음 (1:N 관계)
- 옵션은 반드시 하나의 메뉴에 연결됨

#### 6.1.3 Orders (주문)
주문 정보를 저장하는 테이블입니다.

**필드 구성**:
- `id` (PRIMARY KEY): 주문 고유 ID (자동 증가)
- `order_date` (TIMESTAMP): 주문 일시 (주문 접수 시간)
- `status` (VARCHAR): 주문 상태
  - `"received"`: 주문 접수 (기본값)
  - `"in_progress"`: 제조 중
  - `"completed"`: 제조 완료
- `total_price` (INTEGER): 주문 총 금액 (원 단위)
- `created_at` (TIMESTAMP): 생성 일시
- `updated_at` (TIMESTAMP): 수정 일시

**제약 조건**:
- `order_date`: 필수
- `status`: 필수, 위의 3가지 값 중 하나
- `total_price`: 필수, 0 이상

#### 6.1.4 OrderItems (주문 아이템)
주문에 포함된 개별 메뉴 아이템을 저장하는 테이블입니다.

**필드 구성**:
- `id` (PRIMARY KEY): 주문 아이템 고유 ID (자동 증가)
- `order_id` (FOREIGN KEY): 주문 ID (Orders 테이블 참조)
- `menu_id` (FOREIGN KEY): 메뉴 ID (Menus 테이블 참조)
- `quantity` (INTEGER): 주문 수량
- `unit_price` (INTEGER): 단가 (메뉴 기본 가격 + 선택된 옵션 가격 합계)
- `created_at` (TIMESTAMP): 생성 일시

**제약 조건**:
- `order_id`: 필수, Orders 테이블의 존재하는 ID 참조
- `menu_id`: 필수, Menus 테이블의 존재하는 ID 참조
- `quantity`: 필수, 1 이상
- `unit_price`: 필수, 0 이상

**관계**:
- 하나의 주문은 여러 개의 주문 아이템을 가질 수 있음 (1:N 관계)
- 주문 아이템은 반드시 하나의 주문에 연결됨

#### 6.1.5 OrderItemOptions (주문 아이템 옵션)
주문 아이템에 선택된 옵션을 저장하는 테이블입니다.

**필드 구성**:
- `id` (PRIMARY KEY): 고유 ID (자동 증가)
- `order_item_id` (FOREIGN KEY): 주문 아이템 ID (OrderItems 테이블 참조)
- `option_id` (FOREIGN KEY): 옵션 ID (Options 테이블 참조)
- `created_at` (TIMESTAMP): 생성 일시

**제약 조건**:
- `order_item_id`: 필수, OrderItems 테이블의 존재하는 ID 참조
- `option_id`: 필수, Options 테이블의 존재하는 ID 참조

**관계**:
- 하나의 주문 아이템은 여러 개의 옵션을 가질 수 있음 (1:N 관계)
- 주문 아이템 옵션은 반드시 하나의 주문 아이템에 연결됨

### 6.2 데이터 스키마를 위한 사용자 흐름

#### 6.2.1 메뉴 목록 조회 및 표시
**프런트엔드 → 백엔드**:
1. 주문하기 화면 접속 시 백엔드 API 호출: `GET /api/menus`
2. 백엔드가 Menus 테이블에서 메뉴 목록 조회
3. 각 메뉴에 연결된 Options도 함께 조회
4. 응답 데이터:
   - 메뉴 정보 (id, name, description, price, image_url)
   - 각 메뉴의 옵션 목록 (id, name, price)

**백엔드 → 프런트엔드**:
- 메뉴 목록과 옵션 정보를 JSON 형태로 반환
- 재고 수량 정보는 별도 API로 제공 (관리자 화면용)

**프런트엔드 처리**:
- 받은 메뉴 데이터를 카드 형태로 화면에 표시
- 옵션은 체크박스 형태로 표시

#### 6.2.2 장바구니 관리
**프런트엔드 처리** (백엔드 미호출):
1. 사용자가 메뉴 선택 및 옵션 선택
2. "담기" 버튼 클릭 시 프런트엔드 내부 상태(장바구니)에 추가
3. 장바구니에는 다음 정보 저장:
   - 메뉴 ID, 메뉴명
   - 선택된 옵션 ID 배열
   - 수량
   - 계산된 단가 및 총 가격

#### 6.2.3 주문 생성 및 저장
**프런트엔드 → 백엔드**:
1. 사용자가 "주문하기" 버튼 클릭
2. 백엔드 API 호출: `POST /api/orders`
3. 요청 데이터:
   ```json
   {
     "items": [
       {
         "menu_id": 1,
         "quantity": 2,
         "option_ids": [1, 2],
         "unit_price": 4500
       }
     ],
     "total_price": 9000
   }
   ```

**백엔드 처리**:
1. Orders 테이블에 주문 레코드 생성
   - `order_date`: 현재 시간
   - `status`: "received" (주문 접수)
   - `total_price`: 요청에서 받은 총 금액
2. 각 아이템에 대해 OrderItems 테이블에 레코드 생성
   - `order_id`: 생성된 주문 ID
   - `menu_id`: 요청에서 받은 메뉴 ID
   - `quantity`: 수량
   - `unit_price`: 단가
3. 각 옵션에 대해 OrderItemOptions 테이블에 레코드 생성
4. Menus 테이블의 해당 메뉴 재고(`stock`) 차감
   - 주문된 수량만큼 재고에서 감소
   - 재고가 0보다 작아지지 않도록 처리 (0 이하로 내려가지 않음)
5. 성공 시 생성된 주문 정보 반환

**응답 데이터**:
```json
{
  "id": 123,
  "order_date": "2024-01-15T10:30:00Z",
  "status": "received",
  "total_price": 9000,
  "items": [...]
}
```

#### 6.2.4 관리자 화면 - 재고 현황 표시
**프런트엔드 → 백엔드**:
1. 관리자 화면 접속 시 백엔드 API 호출: `GET /api/menus?include_stock=true`
2. 또는 별도 API: `GET /api/inventory`

**백엔드 처리**:
1. Menus 테이블에서 모든 메뉴 조회
2. 각 메뉴의 재고 수량(`stock`) 포함하여 반환

**응답 데이터**:
```json
[
  {
    "menu_id": 1,
    "name": "아메리카노(ICE)",
    "stock": 10
  },
  ...
]
```

#### 6.2.5 관리자 화면 - 주문 현황 표시
**프런트엔드 → 백엔드**:
1. 관리자 화면 접속 시 백엔드 API 호출: `GET /api/orders`
2. 최신 주문이 먼저 오도록 정렬

**백엔드 처리**:
1. Orders 테이블에서 모든 주문 조회 (또는 특정 상태 필터링 가능)
2. `order_date` 기준 내림차순 정렬
3. 각 주문에 연결된 OrderItems, OrderItemOptions도 함께 조회

**응답 데이터**:
```json
[
  {
    "id": 123,
    "order_date": "2024-01-15T10:30:00Z",
    "status": "received",
    "total_price": 9000,
    "items": [
      {
        "menu_id": 1,
        "menu_name": "아메리카노(ICE)",
        "quantity": 2,
        "options": [
          {
            "id": 1,
            "name": "샷 추가"
          }
        ],
        "unit_price": 4500
      }
    ]
  },
  ...
]
```

#### 6.2.6 주문 상태 변경
**프런트엔드 → 백엔드**:
1. 관리자가 "제조 시작" 또는 "제조 완료" 버튼 클릭
2. 백엔드 API 호출: `PATCH /api/orders/:orderId/status`
3. 요청 데이터:
   ```json
   {
     "status": "in_progress"  // 또는 "completed"
   }
   ```

**백엔드 처리**:
1. 해당 주문 ID로 Orders 테이블에서 주문 조회
2. 주문 상태(`status`) 필드 업데이트
3. 상태 변경 가능 여부 검증 (예: "received" → "in_progress" → "completed" 순서만 허용)

**응답 데이터**:
- 업데이트된 주문 정보 반환

### 6.3 API 설계

#### 6.3.1 메뉴 관련 API

##### GET /api/menus
**설명**: 커피 메뉴 목록 조회

**요청 파라미터**:
- `include_stock` (쿼리, 선택): 재고 정보 포함 여부 (기본값: false)
  - `true`: 재고 정보 포함 (관리자 화면용)
  - `false`: 재고 정보 제외 (주문하기 화면용)

**응답**:
```json
{
  "menus": [
    {
      "id": 1,
      "name": "아메리카노(ICE)",
      "description": "깔끔하고 부드러운 아이스 아메리카노",
      "price": 4000,
      "image_url": "https://example.com/image.jpg",
      "stock": 10,  // include_stock=true일 때만 포함
      "options": [
        {
          "id": 1,
          "name": "샷 추가",
          "price": 500
        },
        {
          "id": 2,
          "name": "시럽 추가",
          "price": 0
        }
      ]
    },
    ...
  ]
}
```

**에러 처리**:
- 500: 서버 오류

##### GET /api/menus/:menuId
**설명**: 특정 메뉴 상세 정보 조회

**응답**:
```json
{
  "id": 1,
  "name": "아메리카노(ICE)",
  "description": "깔끔하고 부드러운 아이스 아메리카노",
  "price": 4000,
  "image_url": "https://example.com/image.jpg",
  "stock": 10,
  "options": [...]
}
```

**에러 처리**:
- 404: 메뉴를 찾을 수 없음
- 500: 서버 오류

#### 6.3.2 재고 관련 API

##### GET /api/inventory
**설명**: 모든 메뉴의 재고 현황 조회 (관리자 화면용)

**응답**:
```json
{
  "inventory": [
    {
      "menu_id": 1,
      "menu_name": "아메리카노(ICE)",
      "stock": 10
    },
    {
      "menu_id": 2,
      "menu_name": "아메리카노(HOT)",
      "stock": 8
    },
    ...
  ]
}
```

##### PATCH /api/menus/:menuId/stock
**설명**: 특정 메뉴의 재고 수량 변경 (관리자 화면의 +/- 버튼)

**요청 본문**:
```json
{
  "change": 1  // 증가: 양수, 감소: 음수
}
```

**응답**:
```json
{
  "menu_id": 1,
  "menu_name": "아메리카노(ICE)",
  "stock": 11  // 변경된 재고 수량
}
```

**에러 처리**:
- 400: 잘못된 요청 (예: 재고가 0인데 감소 시도)
- 404: 메뉴를 찾을 수 없음
- 500: 서버 오류

#### 6.3.3 주문 관련 API

##### POST /api/orders
**설명**: 새로운 주문 생성

**요청 본문**:
```json
{
  "items": [
    {
      "menu_id": 1,
      "quantity": 2,
      "option_ids": [1, 2],
      "unit_price": 4500
    },
    {
      "menu_id": 3,
      "quantity": 1,
      "option_ids": [],
      "unit_price": 5000
    }
  ],
  "total_price": 14000
}
```

**백엔드 처리 로직**:
1. Orders 테이블에 주문 레코드 생성
2. 각 아이템에 대해:
   - OrderItems 테이블에 레코드 생성
   - OrderItemOptions 테이블에 선택된 옵션 레코드 생성
   - Menus 테이블의 해당 메뉴 재고 차감 (수량만큼)
     - 재고가 부족한 경우 에러 반환 (400)
3. 생성된 주문 정보 반환

**응답**:
```json
{
  "id": 123,
  "order_date": "2024-01-15T10:30:00Z",
  "status": "received",
  "total_price": 14000,
  "items": [
    {
      "menu_id": 1,
      "menu_name": "아메리카노(ICE)",
      "quantity": 2,
      "options": [
        {
          "id": 1,
          "name": "샷 추가"
        },
        {
          "id": 2,
          "name": "시럽 추가"
        }
      ],
      "unit_price": 4500
    },
    ...
  ]
}
```

**에러 처리**:
- 400: 잘못된 요청 (재고 부족, 유효하지 않은 메뉴/옵션 ID 등)
- 500: 서버 오류

##### GET /api/orders
**설명**: 주문 목록 조회 (관리자 화면용)

**요청 파라미터** (선택):
- `status` (쿼리): 주문 상태 필터링 ("received", "in_progress", "completed")
- `limit` (쿼리): 조회할 최대 개수
- `offset` (쿼리): 페이지네이션 오프셋

**응답**:
```json
{
  "orders": [
    {
      "id": 123,
      "order_date": "2024-01-15T10:30:00Z",
      "status": "received",
      "total_price": 14000,
      "items": [...]
    },
    ...
  ],
  "total": 50,
  "limit": 20,
  "offset": 0
}
```

**에러 처리**:
- 500: 서버 오류

##### GET /api/orders/:orderId
**설명**: 특정 주문 정보 조회

**응답**:
```json
{
  "id": 123,
  "order_date": "2024-01-15T10:30:00Z",
  "status": "received",
  "total_price": 14000,
  "items": [...]
}
```

**에러 처리**:
- 404: 주문을 찾을 수 없음
- 500: 서버 오류

##### PATCH /api/orders/:orderId/status
**설명**: 주문 상태 변경

**요청 본문**:
```json
{
  "status": "in_progress"  // 또는 "completed"
}
```

**백엔드 처리 로직**:
1. 주문 ID로 Orders 테이블에서 주문 조회
2. 현재 상태와 요청된 상태 검증:
   - "received" → "in_progress" 가능
   - "in_progress" → "completed" 가능
   - 그 외 상태 변경은 에러 반환
3. 상태 업데이트
4. 업데이트된 주문 정보 반환

**응답**:
```json
{
  "id": 123,
  "order_date": "2024-01-15T10:30:00Z",
  "status": "in_progress",
  "total_price": 14000,
  "items": [...]
}
```

**에러 처리**:
- 400: 잘못된 상태 변경 요청
- 404: 주문을 찾을 수 없음
- 500: 서버 오류

#### 6.3.4 통계 관련 API

##### GET /api/orders/stats
**설명**: 주문 통계 조회 (관리자 대시보드용)

**응답**:
```json
{
  "total_orders": 50,
  "received_orders": 10,
  "in_progress_orders": 5,
  "completed_orders": 35
}
```

**에러 처리**:
- 500: 서버 오류

### 6.4 API 공통 사항

#### 6.4.1 응답 형식
- 성공: HTTP 상태 코드 200 (또는 201 for 생성)
- 실패: 적절한 HTTP 상태 코드 (400, 404, 500 등)

#### 6.4.2 에러 응답 형식
```json
{
  "error": {
    "message": "에러 메시지",
    "code": "ERROR_CODE"  // 선택사항
  }
}
```

#### 6.4.3 데이터 타입
- 날짜/시간: ISO 8601 형식 (예: "2024-01-15T10:30:00Z")
- 가격: 정수 (원 단위)
- ID: 정수 (자동 증가)

#### 6.4.4 CORS 설정
- 프런트엔드와 백엔드가 다른 포트에서 실행되므로 CORS 설정 필요
- 허용할 Origin: 프런트엔드 개발 서버 주소 (예: http://localhost:5173)

### 6.5 데이터베이스 관계도 (ERD)

```
Menus (1) ──< (N) Options
  │
  │
  └──< (N) OrderItems
            │
            │
            └──< (N) OrderItemOptions ──> (N) Options

Orders (1) ──< (N) OrderItems
```

**관계 설명**:
- Menus와 Options: 1:N (하나의 메뉴는 여러 옵션을 가짐)
- Orders와 OrderItems: 1:N (하나의 주문은 여러 주문 아이템을 가짐)
- OrderItems와 OrderItemOptions: 1:N (하나의 주문 아이템은 여러 옵션을 가짐)
- OrderItemOptions와 Options: N:1 (여러 주문 아이템 옵션이 하나의 옵션을 참조)